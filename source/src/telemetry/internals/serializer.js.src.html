<!DOCTYPE html><html lang="en" class="loading"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><title>serializer.js</title><link href="../../../../dossier.css" rel="stylesheet" type="text/css"><script src="../../../../types.js" defer></script><header><button class="dossier-menu"><i class="material-icons">menu</i></button><form><input type="search" placeholder="Search" tabindex="1"><i class="material-icons">search</i></form></header><nav class="dossier-nav"></nav><div class="content"><main data-page-data="[null,null,null,[&quot;serializer.js&quot;,&quot;src/telemetry/internals/serializer.js&quot;,[null,&quot;/*&quot;,&quot; * Copyright 2018, Bloombox, LLC. All rights reserved.&quot;,&quot; *&quot;,&quot; * Source and object computer code contained herein is the private intellectual&quot;,&quot; * property of Bloombox, a California Limited Liability Corporation. Use of this&quot;,&quot; * code in source form requires permission in writing before use or the&quot;,&quot; * assembly, distribution, or publishing of derivative works, for commercial&quot;,&quot; * purposes or any other purpose, from a duly authorized officer of Momentum&quot;,&quot; * Ideas Co.&quot;,&quot; *&quot;,&quot; * Unless required by applicable law or agreed to in writing, software&quot;,&quot; * distributed under the License is distributed on an \&quot;AS IS\&quot; BASIS,&quot;,&quot; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&quot;,&quot; * See the License for the specific language governing permissions and&quot;,&quot; * limitations under the License.&quot;,&quot; */&quot;,null,&quot;/**&quot;,&quot; * Bloombox Telemetry: Event Serializer&quot;,&quot; *&quot;,&quot; * @fileoverview Provides routines to serialize and manage event payloads.&quot;,&quot; */&quot;,null,&quot;/*global goog */&quot;,null,&quot;goog.require(&#39;bloombox.logging.error&#39;);&quot;,null,&quot;goog.require(&#39;proto.bloombox.schema.analytics.generic.Event&#39;);&quot;,&quot;goog.require(&#39;proto.bloombox.schema.analytics.generic.Exception&#39;);&quot;,null,&quot;goog.require(&#39;proto.bloombox.schema.analytics.order.Action&#39;);&quot;,null,&quot;goog.require(&#39;proto.bloombox.schema.analytics.product.Action&#39;);&quot;,&quot;goog.require(&#39;proto.bloombox.schema.analytics.product.Impression&#39;);&quot;,&quot;goog.require(&#39;proto.bloombox.schema.analytics.product.View&#39;);&quot;,null,&quot;goog.require(&#39;proto.bloombox.schema.analytics.section.Action&#39;);&quot;,&quot;goog.require(&#39;proto.bloombox.schema.analytics.section.Impression&#39;);&quot;,&quot;goog.require(&#39;proto.bloombox.schema.analytics.section.View&#39;);&quot;,null,&quot;goog.require(&#39;proto.bloombox.schema.services.telemetry.v1beta3.TelemetryEvent&#39;);&quot;,null,&quot;goog.provide(&#39;bloombox.telemetry.internals.EventTypeProperty&#39;);&quot;,&quot;goog.provide(&#39;bloombox.telemetry.internals.SerializationException&#39;);&quot;,null,null,&quot;/**&quot;,&quot; * Enumerates event property by type.&quot;,&quot; *&quot;,&quot; * @enum {string}&quot;,&quot; * @package&quot;,&quot; */&quot;,&quot;bloombox.telemetry.internals.EventTypeProperty = {&quot;,&quot;  EVENT: &#39;genericEvent&#39;,&quot;,&quot;  EXCEPTION: &#39;genericError&#39;,&quot;,&quot;  SECTION_IMPRESSION: &#39;sectionImpression&#39;,&quot;,&quot;  SECTION_VIEW: &#39;sectionView&#39;,&quot;,&quot;  SECTION_ACTION: &#39;sectionAction&#39;,&quot;,&quot;  PRODUCT_IMPRESSION: &#39;productImpression&#39;,&quot;,&quot;  PRODUCT_VIEW: &#39;productView&#39;,&quot;,&quot;  PRODUCT_ACTION: &#39;productAction&#39;,&quot;,&quot;  ORDER_ACTION: &#39;orderAction&#39;&quot;,&quot;};&quot;,null,null,&quot;// noinspection GjsLint&quot;,&quot;/**&quot;,&quot; * Exception that is thrown if an error is encountered during object&quot;,&quot; * serialization.&quot;,&quot; *&quot;,&quot; * @param {string} message Message for the error.&quot;,&quot; * @param {bloombox.telemetry.internals.EventTypeProperty} type Type of event&quot;,&quot; *        that had trouble serializing.&quot;,&quot; * @param {Object} value Event object that had trouble serializing.&quot;,&quot; * @constructor&quot;,&quot; */&quot;,&quot;bloombox.telemetry.internals.SerializationException = function SerializationException(message, type, value) {&quot;,&quot;  /**&quot;,&quot;   * Message for the exception.&quot;,&quot;   *&quot;,&quot;   * @type {string}&quot;,&quot;   */&quot;,&quot;  this.message = message;&quot;,null,&quot;  /**&quot;,&quot;   * Type of event that had trouble serializing.&quot;,&quot;   *&quot;,&quot;   * @type {bloombox.telemetry.internals.EventTypeProperty}&quot;,&quot;   */&quot;,&quot;  this.type = type;&quot;,null,&quot;  /**&quot;,&quot;   * Event object that had trouble serializing.&quot;,&quot;   *&quot;,&quot;   * @type {Object}&quot;,&quot;   */&quot;,&quot;  this.value = value;&quot;,&quot;};&quot;,null,null,&quot;/**&quot;,&quot; * Serialize an event record into a generic TelemetryEvent.&quot;,&quot; *&quot;,&quot; * @param {bloombox.telemetry.internals.EventTypeProperty} type&quot;,&quot; * @param {Object} value&quot;,&quot; * @param {proto.bloombox.schema.analytics.Context=} opt_context Analytics&quot;,&quot; *        context to apply to the resulting event, if any.&quot;,&quot; * @param {boolean=} opt_err Whether to throw an exception if the event cannot&quot;,&quot; *        be resolved or otherwise serialized. Defaults to `true`.&quot;,&quot; * @throws {bloombox.telemetry.internals.SerializationException} When an error&quot;,&quot; *        occurs while serializing the event, if `opt_throw` is truthy.&quot;,&quot; * @return {?proto.bloombox.schema.services.telemetry.v1beta3.TelemetryEvent}&quot;,&quot; *        The resulting telemetry event, or `null` if a failure occurred, and&quot;,&quot; *        `opt_throw` was falsy.&quot;,&quot; */&quot;,&quot;bloombox.telemetry.internals.serializeGeneric = function(type,&quot;,&quot;                                                         value,&quot;,&quot;                                                         opt_context,&quot;,&quot;                                                         opt_err) {&quot;,&quot;  let doThrow = (opt_err === undefined ? true : opt_err);&quot;,&quot;  let event = (&quot;,&quot;    new proto.bloombox.schema.services.telemetry.v1beta3.TelemetryEvent());&quot;,&quot;  switch (type) {&quot;,&quot;    case bloombox.telemetry.internals.EventTypeProperty.EVENT:&quot;,&quot;      event.setGeneric(&quot;,&quot;        /** @type {!proto.bloombox.schema.analytics.generic.Event} */ (value));&quot;,&quot;      break;&quot;,&quot;    case bloombox.telemetry.internals.EventTypeProperty.EXCEPTION:&quot;,&quot;      event.setError(&quot;,&quot;        /** @type {!proto.bloombox.schema.analytics.generic.Exception} */ (&quot;,&quot;          value));&quot;,&quot;      break;&quot;,&quot;    default:&quot;,&quot;      bloombox.logging.error(&quot;,&quot;        &#39;Unrecognized event type, cannot serialize: &#39;, type);&quot;,&quot;      if (doThrow) {&quot;,&quot;        throw new bloombox.telemetry.internals.SerializationException(&quot;,&quot;          &#39;Unable to serialize generic TelemetryEvent.&#39;,&quot;,&quot;          type,&quot;,&quot;          value);&quot;,&quot;      }&quot;,&quot;      return null;  // if doThrow is false, return null&quot;,&quot;  }&quot;,&quot;  if (opt_context !== undefined) {&quot;,&quot;    // apply the context&quot;,&quot;    event.setContext(opt_context);&quot;,&quot;  }&quot;,&quot;  return event;&quot;,&quot;};&quot;]]]"></main><footer><div><a href="https://github.com/jleyba/js-dossier">Generated by dossier</a></div></footer></div><script src="../../../../dossier.js" defer></script>