[null,null,null,["native.js","src/telemetry/context/native.js",[null,"/*"," * Copyright 2018, Bloombox, LLC. All rights reserved."," *"," * Source and object computer code contained herein is the private intellectual"," * property of Bloombox, a California Limited Liability Corporation. Use of this"," * code in source form requires permission in writing before use or the"," * assembly, distribution, or publishing of derivative works, for commercial"," * purposes or any other purpose, from a duly authorized officer of Momentum"," * Ideas Co."," *"," * Unless required by applicable law or agreed to in writing, software"," * distributed under the License is distributed on an \"AS IS\" BASIS,"," * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."," * See the License for the specific language governing permissions and"," * limitations under the License."," */",null,"/**"," * Bloombox Telemetry Context: Native Device"," *"," * @fileoverview Specifies context related to the native hardware that is"," * transmitting events."," */",null,"/*global goog */",null,"goog.require('goog.labs.userAgent.device');","goog.require('goog.userAgent');","goog.require('goog.userAgent.platform');","goog.require('goog.userAgent.product');",null,"goog.require('proto.bloombox.schema.analytics.context.DeviceOS');","goog.require('proto.bloombox.schema.analytics.context.DeviceRole');","goog.require('proto.bloombox.schema.analytics.context.DeviceScreen');","goog.require('proto.bloombox.schema.analytics.context.NativeDeviceContext');","goog.require('proto.bloombox.schema.analytics.context.OSType');","goog.require('proto.bloombox.schema.analytics.context.PixelSize');","goog.require('proto.bloombox.schema.analytics.context.ScreenOrientation');",null,"goog.require('proto.opencannabis.device.DeviceType');",null,"goog.require('proto.opencannabis.structs.VersionSpec');",null,"goog.provide('bloombox.telemetry.buildNativeContext');",null,null,null,"/**"," * Build native device context from the available environment."," *"," * @return {proto.bloombox.schema.analytics.context.NativeDeviceContext}"," * @package"," */","bloombox.telemetry.buildNativeContext = function() {","  let native = (","    new proto.bloombox.schema.analytics.context.NativeDeviceContext());",null,"  // detect device type","  let deviceType = proto.opencannabis.device.DeviceType.UNKNOWN_DEVICE_TYPE;","  if (goog.labs.userAgent.device.isDesktop)","    deviceType = proto.opencannabis.device.DeviceType.DESKTOP;","  else if (goog.labs.userAgent.device.isTablet)","    deviceType = proto.opencannabis.device.DeviceType.TABLET;","  else if (goog.labs.userAgent.device.isMobile)","    deviceType = proto.opencannabis.device.DeviceType.PHONE;","  native.setType(deviceType);","  native.setRole(proto.bloombox.schema.analytics.context.DeviceRole.CLIENT);",null,"  // touchpoints, concurrency and color depth","  if (window.screen) {","    // build screen information","    let viewportHeight = window.screen.availHeight;","    let viewportWidth = window.screen.availWidth;","    let screenHeight = window.screen.height;","    let screenWidth = window.screen.width;","    let pixelDensity = window.devicePixelRatio;",null,"    let pixelSizeViewport = (","      new proto.bloombox.schema.analytics.context.PixelSize());","    pixelSizeViewport.setHeight(viewportHeight);","    pixelSizeViewport.setWidth(viewportWidth);",null,"    let pixelSizeScreen = (","      new proto.bloombox.schema.analytics.context.PixelSize());","    pixelSizeScreen.setHeight(screenHeight);","    pixelSizeScreen.setWidth(screenWidth);",null,"    let deviceScreen = (","      new proto.bloombox.schema.analytics.context.DeviceScreen());","    deviceScreen.setViewport(pixelSizeViewport);","    deviceScreen.setScreen(pixelSizeScreen);","    deviceScreen.setDensity(pixelDensity);","    deviceScreen.setOrientation((window.innerHeight > window.innerWidth) ?","      proto.bloombox.schema.analytics.context.ScreenOrientation.LANDSCAPE :","      proto.bloombox.schema.analytics.context.ScreenOrientation.PORTRAIT);","    native.setScreen(deviceScreen);","  }",null,"  // detect OS type and version","  let osType = proto.bloombox.schema.analytics.context.OSType.OS_UNKNOWN;","  let osVersion = goog.userAgent.platform.VERSION;",null,"  if (goog.userAgent.IPAD ||","    goog.userAgent.IPHONE ||","    goog.userAgent.IPOD ||","    goog.userAgent.IOS)","    osType = proto.bloombox.schema.analytics.context.OSType.IOS;","  else if ((goog.userAgent.WINDOWS ||","      goog.userAgent.EDGE_OR_IE) &&","    goog.userAgent.MOBILE)","    osType = proto.bloombox.schema.analytics.context.OSType.WINDOWS_PHONE;","  else if (goog.userAgent.WINDOWS ||","    goog.userAgent.EDGE_OR_IE)","    osType = proto.bloombox.schema.analytics.context.OSType.WINDOWS;","  else if (goog.userAgent.product.ANDROID)","    osType = proto.bloombox.schema.analytics.context.OSType.ANDROID;","  else if (goog.userAgent.MAC)","    osType = proto.bloombox.schema.analytics.context.OSType.MACOS;","  else if (goog.userAgent.LINUX)","    osType = proto.bloombox.schema.analytics.context.OSType.LINUX;",null,"  let osObj = new proto.bloombox.schema.analytics.context.DeviceOS();","  let osVersionObj = new proto.opencannabis.structs.VersionSpec();","  osVersionObj.setName(osVersion);","  osObj.setType(osType);","  osObj.setVersion(osVersionObj);","  native.setOs(osObj);","  return native;","};"]]]