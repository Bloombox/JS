env:
  global:
  - CC_TEST_REPORTER_ID=18c66a6738c0718369a787a4cb2e97f0bef655c5ccb747332486636fac394664
  - CODACY_PROJECT_TOKEN=61032013369f42c2883a039c33987e2c
  - SAUCE_USERNAME=bloomlabs
  - secure: PrWcsspNNByfBoQJpGc3w7BLDiUm7P+gHvTA3u6cCLgS8hFMpEDsci9JAJ02iYPYGmhNrdGI4TC6phmplvXLFfM8rIVvDCQgOrZp+wzK+03QjlzzZ2wneE6YGAg/OKTnpcKxhnZ3XnTNZjuC9LmT/ld7No8niYWXFmIP8dokJMfdHkL4fuWcfgYKwHAsqb+EA1W5EnZIM97sKq6BE5MExEHKECIQVsW3KhpEpVqKEB5MDy4/HmC7oJPSybuSZ5TaIYG6wACAnLf9gvbL5EpmeAyvs5Mk9xG5Yhx1jEF/5hiYBe/6PCLlFQSXjADNWUisluRI4DM5Uq8PiUxWwR1RqolejD/0f7JeNnX60SIpz1u4yItDO58AwMjqR9gemzc8+OJadRjoKZ8AHT2eH1XBbGk6sH3fiTXfL+XI/lWVnYrjK9OZ2r3Z536xrOgg5+kFhxn9Tz48BH/kA4RnIoOg7eOqgk+eIfiS+9I3WoccP373uWncqV/mauULRfgFAxqkLZT2GZ9y/48CPgIIy9+QZ6Agvwv9LKbXK4GR5kRyTP3CvY5tk42IgT62xVWCGkvxbALk0CxnmkW72CGYlhoryyeJuq3u2vElSz9UsxAVbeEe+jm78MUK8tjfZ6pbZ6slYO8H9DdRaFjmvc5iE13rTKUGtHk6iJ47UozLKc6g9GU=
  - secure: W9L0BnACp9wxr3YrCyFqbV1dDcJlq9i4KKObnjI/f/e52ssIBYloiIKIJeSJ+bFaRtWuTHqb7rC/i9R0/TTQa2As4QmqPaV/FS8ot7HM/H/h0IWBFDHEJXFaUQK8EkHzivvG7m03skRp+OkXHB5xikk+kEKSn+kW6AFub4QSOvKCfzSeTRa4UlVv+t2h8qDYAGTMlMxeKLoZfMUt7rjViOedzv2Aet1inOK4/uK8aqGKu7FPFGNq3M7OqmCUIMjzVxoPEg3TxC9HebvXTBE0uf5Ytnuce4g9oduo1Lssa4nnaj0VDlfWwWKQ2GnwxKNhSXCzvk7F0XBl73hlkiF01ZootE+q1kHPjE33kLtuWY0RNKsNDhkJssQOYnRYRrpl8VFDYhfQUVrrkv8TUxlBDJoI2RGvP+yJ6eO6P0xGJ19ZrAxC15FEGCjdxLAIpj0P1N8MeNuN7VhRtLjb0yzrwzYEsEoJZI3G1Aapsr0d/fEb96z5DkjER95lIUSlWcHBvOq4T9HmaAcWU8UUnZkMchn/UsRr5PYiTs6/MNSRRbS2j9RImDQDB1sFG4wgAZW3B/6en+hPfwiBwaP61go4nLH2X6DHEEgCDjhLvwm9c7zbzgpDX4lPrarHVK9pD11rfuHP47iLgo5J2x79AL2hUUdGAr4iMXv5UaIjj+oNyJk=
addons:
  browserstack:
    username: samgammon2
    access_key:
      secure: jXUc+ILvweMNlYYtGcC4+WC8tZivgIq90g23bsHeLUc73q+tW5V6GoiAkawTaYmJES9r8WnUZuSvLqrnq+Z8TktGXakmRZzmpunkJXFB6wQr+PjPfvHJ4UJ/1WN5jJWMs/wuCgUGdXVrCErps4AvaR8tN1o4fWJkjtQGucKooXsE2M2yj6c+idL/CYyInCZ5W4sCH56tgLyAlqUqOd8CTNjxqujGbTt2MwJZoSYjyGZ+NCM8lfFYTxIHAe/xvotGPgl4lPeCcYYFpVedms6gR39K5uB+ifk3USJzhBH7J5CHzl7OT7CUvLyqHfYQvK9/vITB73jjAaERVDwc/lU71p1kgkL43HfaIgsAV6DXXtT1wWI+gx4VO1JBzeuHMPvR1oxMr/kPDJuZnMO+/XBdGCMrHUwGFhul6df8ZQ+8b+oyLQ43QlbJrYyKhV1Cw3xJLzgyD1+bAFFhTlFoQKLlrE+rvDvF0eeZHuJO1gnt22IJwZOFCtksmmNIAqAMsjdSqDx2NtQSCa+vhUzXlvfIREAsKScDNSte2qw7b4xdytO68Hs8+PsDz/WaxpdCIdvbHKoi+6PqRYvRq0UflFAgDHZJJw1RtWA5s8y8KeXpqFTv8jCvNWesZbB0VC/ksjd9BKgMkIC8020ZkonLfKbsH4otUWEVQASG0qRkw6VaHTg=
  sauce_connect:
    username: bloomlabs
  jwt:
    secure: eEd/V2zMF32QYNT3m2v3HnCc0XHbwelAx58q75QPg9yZCs+2Nidt83jLkhJ++sHrWW+icEflP4ZpR8gx9jJRE73hSVDS6KrAf0adgFOS+feitC7s+J44qe/N6TwSZIaqyfR/AdqUqdb1rmJjbz/HPSIMe1iEY/DgHSamYijeue8i7Ls4k0omYZsibbp+WchNS05RCM4AoFrTSvEkZuFgUEs31Dyay8QOLVrTwCzOFyd7LzhbkttFJLSLCFhWjz3Edfc1xz4U4BGA70c8kMDLpVUwswau4u4vHgX92rX4lLL88b+zd4Fu/BG48OSyOzlUGtxDI0m3fr+pPr2WBoyqoVetitutzAJZizMWYBlA0PBwlleH/jC0thXHSaW5W9lyErEQug56Lz3aznq1kyeXmZCPrXk7zNrxfjdv4KM6wpiEXKe3i1P4sOUk0LMbhV4wo1I4EzhaptY7A4DEfS9ImXtuziaZAlFS+zHcEA6o2dJ9uGVS0dBbmDlfxHtCJhHhzOHgIB3DFm1CHJ7tJcVKqmxeIlwC50V9xG8DjQ2S6mC+D4gzZ57KCixfiEnf6XlWgkjIdtdY5teQK4wLaYF5U7VFwtllprYjTrKk0/lhnAHtgoFZwKo3ycjfmLZqv+YTnNEXbTUPwBqeYEw5ZnbR0Mayns9Ct5SrEADJKScw22w=
language: node_js
node_js:
- '8'
cache:
  yarn: true
  directories:
  - node_modules/
before_script:
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
- curl -L https://github.com/codacy/codacy-coverage-reporter/releases/download/2.0.2/codacy-coverage-reporter-2.0.2-assembly.jar > ./codacy-coverage-reporter.jar
- chmod +x ./cc-test-reporter
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- sleep 3
- yarn
- ./cc-test-reporter before-build
script:
- make
- make serve &
- karma start karma-ci.conf.js --single-run
after_script:
- cp -fv target/coverage/cobertura.xml ./cobertura.xml
- ./cc-test-reporter after-build -d --exit-code $TRAVIS_TEST_RESULT --coverage-input-type cobertura --prefix /home/travis/build/Bloombox/JS
- java -jar codacy-coverage-reporter.jar com.codacy.CodacyCoverageReporter --language Javascript -r target/coverage/cobertura.xml --prefix /home/travis/build/Bloombox/JS
